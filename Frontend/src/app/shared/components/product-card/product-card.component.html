<div
  [routerLink]="['/products', product.id]"
  class="group cursor-pointer bg-white rounded-lg border hover:shadow-lg transition-shadow p-4"
>
  <!-- Image -->
  <div class="aspect-square mb-4 overflow-hidden rounded-lg bg-gray-100 relative">
    <img
      [src]="product.image"
      [alt]="product.name"
      class="w-full h-full object-cover group-hover:scale-105 transition-transform"
    />

    <!-- Wishlist Button -->
    <button
      (click)="toggleWishlist($event)"
      class="absolute top-2 right-2 p-2 bg-white/80 backdrop-blur-sm rounded-md hover:bg-white"
      [class.text-red-500]="isInWishlist"
    >
      <lucide-icon
        [img]="Heart"
        class="h-4 w-4"
        [class.fill-current]="isInWishlist"
      ></lucide-icon>
    </button>
  </div>

  <!-- Product Info -->
  <h3 class="font-semibold mb-1 line-clamp-2">{{ product.name }}</h3>
  @if (product.category) {
    <p class="text-sm text-gray-500 mb-2">{{ product.category }}</p>
  }

  <!-- Rating -->
  @if (product.rating > 0) {
    <div class="flex items-center gap-1 mb-3">
      <lucide-icon [img]="Star" class="h-4 w-4 fill-yellow-400 text-yellow-400"></lucide-icon>
      <span class="text-sm font-medium">{{ product.rating }}</span>
      @if (product.reviews) {
        <span class="text-xs text-gray-500">({{ product.reviews }})</span>
      }
    </div>
  }

  <!-- Price -->
  <div class="flex items-center justify-between mb-4">
    <div>
      <p class="text-2xl font-bold text-primary">
        ${{ product.price.toFixed(2) }}
      </p>
      <p class="text-xs text-gray-500">{{ product.unit }}</p>
    </div>
  </div>

  <!-- Add to Cart Button -->
  <button
    (click)="addToCart($event)"
    [disabled]="!product.inStock"
    class="w-full flex items-center justify-center gap-2 px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 disabled:bg-gray-300 disabled:cursor-not-allowed"
  >
    <lucide-icon [img]="ShoppingCart" class="h-4 w-4"></lucide-icon>
    {{ product.inStock ? 'Add to Cart' : 'Out of Stock' }}
  </button>
</div>
